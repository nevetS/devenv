---
# create a self-signed ClusterIssuer
apiVersion: cert-manager.io/v1
kind: ClusterIssuer
metadata:
  name: tatooine-selfsigned-issuer
spec:
  selfSigned: {}
    # we'll skip the Certificate Revocation List for now
    # crlDistributionPoints:
    #   - "http://crl.tatooine.kube"    
---
# generate the root-secret certificate required for creating a CA
apiVersion: cert-manager.io/v1
kind: Certificate
metadata:
  name: tatooine-ca
  namespace: cert-manager
spec:
  isCA: true
  commonName: tatooine-ca
  secretName: root-secret
  # subject is required per X.509 RFC 5280, section 4.1.2.4 https://tools.ietf.org/html/rfc5280#section-4.1.2.4
  subject:
    organizations:
      - tatooine.kube
  privateKey:
    algorithm: ECDSA
    size: 256
  issuerRef:
    name: tatooine-selfsigned-issuer
    kind: ClusterIssuer
    group: cert-manager.io
---
# create the CA as a ClusterIssuer
#  Issuers can create certificates in a namespace,
#  ClusterIssuers can create certs in any namespace
apiVersion: cert-manager.io/v1
kind: ClusterIssuer
metadata:
  name: tatooine-ca-issuer
spec:
  ca:
    secretName: root-secret
